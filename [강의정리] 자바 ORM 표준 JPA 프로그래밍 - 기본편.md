
## [1] JPA ì†Œê°œ
---
### âœ… SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì˜ ë¬¸ì œì 
>  **ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì˜ ëª¨ë¸ë§** ê³¼ **ê°ì²´ì§€í–¥ ëª¨ë¸ë§** ê¸°ë²• ê°„ì˜ ì°¨ì´ë¡œ ì¸í•´ ê°ì²´ë‹µê²Œ ëª¨ë¸ë§ í• ìˆ˜ë¡ ë§¤í•‘ ìž‘ì—…ë§Œ ëŠ˜ì–´ë‚˜ê²Œ ë˜ê³ , ê²°êµ­ ë°ì´í„° ëª¨ë¸ë§ì— ë§žì¶° í”„ë¡œê·¸ëž¨ì„ ì„¤ê³„í•  ìˆ˜ ë°–ì— ì—†ì–´ì§„ë‹¤.

#
### âœ… ê°ì²´ë¥¼ Collectionì— ì €ìž¥í•˜ë“¯ì´ DBì— ì €ìž¥í•  ìˆ˜ ì—†ì„ê¹Œ?
> Java ORM í‘œì¤€ì¸ JPAë¥¼ ì´ìš©í•˜ë©´ ê°€ëŠ¥í•˜ë‹¤. JPAëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ DB ì‚¬ì´ì—ì„œ ë™ìž‘í•˜ë©° ì´ ë‘˜ì„ ë§¤í•‘í•´ì£¼ëŠ”ë°, ì´ë¥¼ í†µí•´ íŒ¨ëŸ¬ë‹¤ìž„ì˜ ë¶ˆì¼ì¹˜ë¥¼ í•´ê²°í•˜ê³ , SQL ì¤‘ì‹¬ì ì¸ ê°œë°œì—ì„œ ê°ì²´ ì¤‘ì‹¬ ê°œë°œë¡œ ë‚˜ì•„ê°ˆ ìˆ˜ ìžˆë‹¤.

#
### âœ… JPAì˜ ì„±ëŠ¥ ìµœì í™” ê¸°ëŠ¥
 1. 1ì°¨ ìºì‹œì™€ ë™ì¼ì„±(identity) ë³´ìž¥
> - ê°™ì€ íŠ¸ëžœìž­ì…˜ ì•ˆì—ì„œëŠ” ê°™ì€ ì—”í‹°í‹°ë¥¼ ë°˜í™˜ : ì•½ê°„ì˜ ì¡°íšŒì„±ëŠ¥ í–¥ìƒ
> - DB Isolation Levelì´ Read Commit ì´ì–´ë„ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ Repeatable Read ë³´ìž¥
 2. íŠ¸ëžœìž­ì…˜ì„ ì§€ì›í•˜ëŠ” ì“°ê¸° ì§€ì—°(transactional write-behind)
> - íŠ¸ëžœìž­ì…˜ì„ ì»¤ë°‹í•  ë•Œê¹Œì§€ INSERT SQLì„ ëª¨ìŒ
> - JDBC BATCH SQL ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì„œ í•œë²ˆì— SQL ì „ì†¡
> - UPDATE, DELETEë¡œ ì¸í•œ Row lock ì‹œê°„ ìµœì†Œí™”
> - íŠ¸ëžœìž­ì…˜ ì»¤ë°‹ ì‹œ UPDATE, DELETE SQL ì‹¤í–‰í•˜ê³  ë°”ë¡œ ì»¤ë°‹
 3. ì§€ì—° ë¡œë”©(Lazy Loading)
> - ì§€ì—° ë¡œë”© : ê°ì²´ê°€ ì‹¤ì œ ì‚¬ìš©ë  ë•Œ ë¡œë”©
>> ex. SELECT * FROM MEMBER; SELECT * FROM TEAM;
> - ì¦‰ì‹œ ë¡œë”© : JOIN SQLë¡œ í•œë²ˆì— ì—°ê´€ëœ ê°ì²´ê¹Œì§€ ë¯¸ë¦¬ ì¡°íšŒ
>> ex. SELECT M.*, T.* FROM MEMBER JOIN TEAM ...

#
## [2] JPA ì‹œìž‘í•˜ê¸°
---
### âœ… JPA ì„¤ì • ì¤‘ ì¤‘ìš”í•œ ë¶€ë¶„
- JPA ì„¤ì •ì€ /META-INF/persistence.xml ì— ìœ„ì¹˜í•´ì•¼ í•¨
- javax.persitenceë¡œ ì‹œìž‘í•˜ëŠ” ê±´ JPA í‘œì¤€ì†ì„±, hibernateë¡œ ì‹œìž‘í•˜ëŠ”ê±´ í•˜ì´ë²„ë„¤ì´íŠ¸ ì „ìš© ì†ì„±ìž„
- **hibernate.dialect ì†ì„±** ì§€ì •
    > ðŸ’¡ _ë°ì´í„°ë² ì´ìŠ¤ ë°©ì–¸ì´ëž€?_  
    > SQL í‘œì¤€ì„ ì§€í‚¤ì§€ ì•ŠëŠ” DBë§Œì˜ ê³ ìœ í•œ ê¸°ëŠ¥ì„ ë°©ì–¸ì´ë¼ê³  í•˜ë©°, JPAëŠ” íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ì— ì¢…ì†ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì´ëŸ¬í•œ ë°ì´í„°ë² ì´ìŠ¤ ë°©ì–¸ì„ ì§€ì›í•´ì•¼ í•œë‹¤. ì‹¤ì œ HibernateëŠ” 40ê°€ì§€ ì´ìƒì˜ ë°ì´í„°ë² ì´ìŠ¤ ë°©ì–¸ì„ ì§€ì›í•œë‹¤.
    > - MySQLDialect : MySQL SQL ìƒì„±
    > - OracleDialect : Oracle SQL ìƒì„±
    > - H2Dialect : H2 SQL ìƒì„±  
- java 11 ì˜¤ë¥˜ í•´ê²° : https://www.inflearn.com/questions/13985

### âœ… JPA êµ¬ë™ ë°©ì‹
- Javaì˜ Persistence í´ëž˜ìŠ¤ê°€ META-INF/persistence.xmlì— ì €ìž¥ëœ ì„¤ì • ì •ë³´ë¥¼ ì¡°íšŒí•œë‹¤.
- ì„¤ì •ì— ë”°ë¼ EntityManagerFactoryë¥¼ ìƒì„±í•œë‹¤.
    > EntityManagerFactoryëŠ” í•˜ë‚˜ë§Œ ìƒì„±í•´ì„œ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ì— ê³µìœ í•¨
- EntityManagerFactoryëŠ” EntityManager ë“¤ì„ ìƒì„±í•œë‹¤.
    > EntityManagerëŠ” ì“°ë ˆë“œ ê°„ì— ê³µìœ ê°€ ë˜ì§€ ì•Šìœ¼ë©°, JPAì˜ ëª¨ë“  ë°ì´í„° ë³€ê²½ì€ íŠ¸ëžœìž­ì…˜ ì•ˆì—ì„œ ì‹¤í–‰ë¨

### âœ… JPA ì–´ë…¸í…Œì´ì…˜
- @Entity : JPAê°€ ê´€ë¦¬í•  ê°ì²´
- @Id : ë°ì´í„°ë² ì´ìŠ¤ PKì™€ ë§¤í•‘ 

### âœ… JPQL
- ê°ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ê²€ìƒ‰í•˜ëŠ” ê°ì²´ ì§€í–¥ ì¿¼ë¦¬
- ë’¤ì—ì„œ ì•„ì£¼ ìžì„¸ížˆ ë‹¤ë£° ì˜ˆì •ì´ê¸° ë•Œë¬¸ì— ì´ëŸ°ê±¸ ì‚¬ìš©í•œë‹¤ëŠ” ì •ë„ë§Œ ì•Œê³  ê°ˆ ê²ƒ 

#
## [3] ì˜ì†ì„± ê´€ë¦¬ - ë‚´ë¶€ ë™ìž‘ ë°©ì‹ 
---
### âœ… ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸(PersistenceContext)
- ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” ë…¼ë¦¬ì ì¸ ê°œë…ìœ¼ë¡œ ëˆˆì— ë³´ì´ì§€ ì•ŠëŠ”ë‹¤.
- JPAëŠ” EntityManagerë¥¼ í†µí•´ PersistenceContextì— ì ‘ê·¼í•œë‹¤.
- J2SE ì—ì„œëŠ” 1:1ë¡œ ë§¤í•‘ë˜ê³ , J2EE/ìŠ¤í”„ë§ ê°™ì€ ì»¨í…Œì´ë„ˆ í™˜ê²½ì—ì„  N:1ë¡œ ë§¤í•‘ëœë‹¤.
> **ì—”í‹°í‹° ìƒëª…ì£¼ê¸°**
> - ë¹„ì˜ì† : ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ ì „í˜€ ê´€ê³„ê°€ ì—†ëŠ” ìƒˆë¡œìš´ ìƒíƒœ 
> - ì˜ì† : ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ê´€ë¦¬ë˜ëŠ” ìƒíƒœ // em.persist(member)
> - ì¤€ì˜ì† : ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ìž¥ë˜ì—ˆë‹¤ê°€ ë¶„ë¦¬ëœ ìƒíƒœ // em.detach(member)
> - ì‚­ì œ : ì‚­ì œëœ ìƒíƒœ // em.remove(member)

> **ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ì´ì **
> - 1ì°¨ ìºì‹œ : ì¡°íšŒ ì„±ëŠ¥ ê°œì„ 
>   - 1ì°¨ ìºì‹œì—ì„œ ì¡°íšŒí•´ì˜¤ëŠ” ê²ƒê³¼ ê°™ì§€ë§Œ, ì„±ëŠ¥ í–¥ìƒì´ íš¨ê³¼ëŠ” ë¯¸ë¯¸í•¨.
>   - íŠ¸ëžœìž­ì…˜ ë‹¨ìœ„ë¡œ ìƒì„±ë˜ì—ˆë‹¤ê°€ ì‚¬ë¼ì§€ê¸° ë•Œë¬¸ì— íš¨ê³¼ê°€ í¬ì§€ ì•ŠìŒ.
> - 1ì°¨ ìºì‹œ : ë™ì¼ì„± ë³´ìž¥
>   - 1ì°¨ ìºì‹œë¡œ ë°˜ë³µ ê°€ëŠ¥í•œ ì½ê¸°(REPEATABLE READ) ë“±ê¸‰ì˜ íŠ¸ëžœìž­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ì„ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì°¨ì›ì—ì„œ ì œê³µí•¨. 
> - íŠ¸ëžœìž­ì…˜ì„ ì§€ì›í•˜ëŠ” ì“°ê¸° ì§€ì—°
>   - ì»¤ë°‹ ì´ì „ì—ëŠ” DBì— insert í•˜ì§€ ì•Šë‹¤ê°€, commit ì‹œì ì— í•œ ë²ˆì— ì“°ê¸° ìž‘ì—…ì„ ìˆ˜í–‰
> - ë³€ê²½ ê°ì§€(Dirty Checking)
>   - setter ì—°ì‚°ì„ í†µí•´ ê°ì²´ì˜ ì •ë³´ë¥¼ ë³€ê²½í•œ í›„ì— em.update ì™€ ê°™ì€ ë³„ë„ì˜ ìž‘ì—… ì—†ì´ë„, ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ê´€ë¦¬ë˜ê³  ìžˆëŠ” ê°ì²´ì˜ ë³€ê²½ ë‚´ìš©ì„ ê°ì§€í•˜ì—¬ ë°˜ì˜í•¨
> - ì§€ì—° ë¡œë”©(Lazy Loading)

### âœ… í”ŒëŸ¬ì‹œ(flush)
> ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë³€ê²½ë‚´ìš©ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•¨.
> 
> í”ŒëŸ¬ì‹œì—ëŠ” ì„¸ ê°€ì§€ ë°©ë²•ì´ ìžˆìŒ.
> - em.flush() : ì§ì ‘ í˜¸ì¶œ
> - íŠ¸ëžœìž­ì…˜ ì»¤ë°‹ : í”ŒëŸ¬ì‹œ ìžë™ í˜¸ì¶œ
> - JPQL ì¿¼ë¦¬ ì‹¤í–‰ : í”ŒëŸ¬ì‹œ ìžë™ í˜¸ì¶œ
>   - JPQL ì¿¼ë¦¬ ì‹¤í–‰ ì‹œì ì— í”ŒëŸ¬ì‹œê°€ í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤ë©´, ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ìž¥í•œ ì´í›„ ì»¤ë°‹ ì´ì „ì— JPQLì„ ì‚¬ìš©í•´ í•´ë‹¹ ê°ì²´ë¥¼ select í•˜ê³ ìž í•˜ë©´ ì›í•˜ëŠ” ê°ì²´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ì„ ê²ƒì´ë‹¤. 

> í”ŒëŸ¬ì‹œì˜ íŠ¹ì„±
> - ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ë¹„ìš°ì§€ ì•ŠìŒ
> - ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë³€ê²½ë‚´ìš©ì„ DBì— ë™ê¸°í™” í•¨
> - ë°ì´í„° ì˜ì†ì„± ê´€ë¦¬ë¥¼ ìœ„í•´ì„œëŠ” ê²°êµ­ íŠ¸ëžœìž­ì…˜ì´ë¼ëŠ” ìž‘ì—… ë‹¨ìœ„ê°€ ê°€ìž¥ ì¤‘ìš”í•˜ë‹¤. íŠ¸ëžœìž­ì…˜ì´ ì»¤ë°‹ë˜ì§€ ì•Šìœ¼ë©´ ë³€ê²½ë‚´ìš©ì´ í° ì˜ë¯¸ê°€ ì—†ê¸° ë•Œë¬¸ì—, ì»¤ë°‹ ì§ì „ì—ë§Œ ë™ê¸°í™” í•˜ë©´ ëœë‹¤. ë”°ë¼ì„œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ íŠ¸ëžœìž­ì…˜ ì£¼ê¸°ë¥¼ ë§žì¶°ì„œ(ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•˜ë©° íŠ¸ëžœìž­ì…˜ì„ ì‹œìž‘í•˜ê³  ì»¤ë°‹í•˜ë©° ì»¨í…ìŠ¤íŠ¸ë¥¼ ë‚ ë¦¬ëŠ”?) ì„¤ê³„í•˜ê³  ê°œë°œí•´ì•¼ í•œë‹¤. ë˜í•œ, ì´ëŸ° ì´ìœ ë¡œ JPAë¥¼ ì‚¬ìš©í•˜ë©´ì„œ ë°ì´í„° ë™ê¸°í™”ë¥¼ ë„ˆë¬´ í¬ê²Œ ìƒê°í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.

### âœ… ì¤€ì˜ì† ìƒíƒœ(detached)
- ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°ê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ë¶„ë¦¬ë˜ê³ , ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ì œê³µí•˜ëŠ” ê¸°ëŠ¥(Dirty check ë“±)ì„ ì‚¬ìš©í•˜ì§€ ëª»í•˜ê²Œ ë¨.
> ì¤€ì˜ì† ìƒíƒœë¡œ ë§Œë“œëŠ” ë²•
> - em.detach(entity)
> - em.clear()
> - em.close()

